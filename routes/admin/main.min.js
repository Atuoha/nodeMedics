'use strict';const express=require("express"),app=express(),router=express.Router(),Contact=require("../../models/Contact"),Department=require("../../models/Department"),Doctor=require("../../models/Doctor"),Appointment=require("../../models/Appointment"),Research=require("../../models/Research"),Media=require("../../models/Media"),Service=require("../../models/Service"),Faq=require("../../models/Faq"),Testimony=require("../../models/Testimony"),User=require("../../models/User");
router.all("/*",(a,e,b)=>{a.app.locals.layout="admin";b()});
router.get("/",(a,e)=>{const b=[User.countDocuments().exec(),Appointment.countDocuments().exec(),Doctor.countDocuments().exec(),Department.countDocuments().exec(),Research.countDocuments().exec(),Testimony.countDocuments().exec(),Service.countDocuments().exec(),Faq.countDocuments().exec(),Contact.countDocuments().exec(),Media.countDocuments().exec()];User.findOne({_id:a.user.id}).then(f=>{Deptment.find().then(c=>{Doctor.find().then(d=>{Promise.all(b).then(([g,h,k,l,m,n,p,q,r,t])=>{e.render("admin/index",
{userCount:g,appointCount:h,doctorCount:k,deptCount:l,researchCount:m,testimonyCount:n,serviceCount:p,faqCount:q,contactCount:r,mediaCount:t,profile:f,doctors:d,depts:c})})}).catch(d=>console.log(d))}).catch(c=>console.log(c))}).catch(f=>console.log)});module.exports=router;