'use strict';const express=require("express"),app=express(),router=express.Router(),Service=require("../../models/Service"),faker=require("faker");router.all("/*",(b,c,a)=>{b.app.locals.layout="admin";a()});router.get("/",(b,c)=>{Service.find().then(a=>{c.render("admin/our_services",{services:a})}).catch(a=>console.log(a))});router.get("/create",(b,c)=>{c.render("admin/our_services/create")});router.get("/dummy",(b,c)=>{c.render("admin/our_services/dummy")});
router.get("/edit/:id",(b,c)=>{Service.findOne({_id:b.params.id}).then(a=>{c.render("admin/our_services/edit",{service:a})}).catch(a=>console.log(a))});router.post("/create",(b,c)=>{const a=new Service;a.name=b.body.name;a.font=b.body.font;a.content=b.body.content;a.save().then(d=>{b.flash("success_msg",`${d.name} has been created successfully :)`);c.redirect("/admin/service")}).catch(d=>console.log)});
router.post("/dummy",(b,c)=>{for(let a=0;a<b.body.number;a++){const d=new Service;d.name=faker.name.title();d.font="ambulance";d.content=faker.lorem.sentence();d.save().then(e=>{b.flash("success_msg",`${b.body.number} dummy services has been created successfully :)`);c.redirect("/admin/service")}).catch(e=>console.log)}});
router.post("/update/:id",(b,c)=>{Service.findOne({_id:b.params.id}).then(a=>{a.name=b.body.name;a.font=b.body.font;a.content=b.body.content;a.save().then(d=>{b.flash("success_msg",`${a.name} has been updated successfully :)`);c.redirect("/admin/service")}).catch(d=>console.log)}).catch(a=>console.log)});
router.get("/delete/:id",(b,c)=>{Service.findOne({_id:b.params.id}).then(a=>{a.delete().then(d=>{b.flash("success_msg",`${a.name} has been deleted successfully :)`);c.redirect("/admin/service")}).catch(d=>console.log)}).catch(a=>console.log)});module.exports=router;