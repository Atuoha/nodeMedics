'use strict';const express=require("express"),app=express(),router=express.Router(),faker=require("faker"),Faq=require("../../models/Faq");router.all("/*",(b,d,a)=>{b.app.locals.layout="admin";a()});router.get("/",(b,d)=>{Faq.find().populate("user").then(a=>{d.render("admin/faq",{faqs:a})}).catch(a=>console.log(a))});router.get("/create",(b,d)=>{d.render("admin/faq/create")});router.get("/dummy",(b,d)=>{d.render("admin/faq/dummy")});
router.get("/edit/:id",(b,d)=>{Faq.findOne({_id:b.params.id}).then(a=>{d.render("admin/faq/edit",{faq:a})}).catch(a=>console.log(a))});router.post("/create",(b,d)=>{const a=new Faq;a.user=b.user.id;a.question=b.body.question;a.tag=b.body.tag;a.answer=b.body.answer;a.save().then(c=>{b.flash("success_msg",`${c.question} created successfully :)`);d.redirect("/admin/faq")}).catch(c=>console.log(c))});
router.post("/dummy",(b,d)=>{for(let a=0;a<b.body.number;a++){const c=new Faq;c.user=b.user.id;c.question=faker.random.word();c.tag=faker.random.word();c.answer=faker.lorem.sentence();c.save().then(e=>{b.flash("success_msg",`${b.body.number} dummies created successfully :)`);d.redirect("/admin/faq")}).catch(e=>console.log(e))}});
router.post("/update/:id",(b,d)=>{Faq.findOne({_id:b.params.id}).then(a=>{a.question=b.body.question;a.tag=b.body.tag;a.answer=b.body.answer;a.save().then(c=>{b.flash("success_msg",`${c.question} has been updated  successfully :)`);d.redirect("/admin/faq")}).catch(c=>console.log(c))}).catch(a=>console.log(a))});
router.post("/delete/:id",(b,d)=>{Faq.findOne({_id:b.params.id}).then(a=>{a.delete().then(c=>{b.flash("success_msg",`${c.question} has been deleted  successfully :)`);d.redirect("/admin/faq")}).catch(c=>console.log(c))}).catch(a=>console.log(a))});module.exports=router;